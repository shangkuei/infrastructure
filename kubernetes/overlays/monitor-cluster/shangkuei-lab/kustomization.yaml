---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Grafana Alloy - unified telemetry collector
# Collects logs from Kubernetes pods and sends to Loki
# Note: Loki is deployed via monitor-operator overlay

resources:
  - helmrelease-alloy.yaml
  - configmap-alloy.yaml
  # Grafana instance managed by grafana-operator
  - grafana-instance.yaml
  # Grafana datasources (Prometheus, Loki)
  - grafana-datasource-prometheus.yaml
  - grafana-datasource-loki.yaml
  # Grafana dashboards (managed via grafana-operator CRs)
  # Source 1: dotdc/grafana-dashboards-kubernetes + Node Exporter Full (grafana.com IDs)
  - grafana-dashboards-kubernetes.yaml
  # Source 2: kube-prometheus jsonnet (generated via: cd dashboards && make build)
  - grafana-dashboards-kube-prometheus.yaml

labels:
  - pairs:
      app.kubernetes.io/instance: shangkuei-lab
      app.kubernetes.io/environment: lab
