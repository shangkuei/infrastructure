# Backend configuration for talos-cluster-edatw-cluster environment
# This file contains Terraform backend settings for storing state in Cloudflare R2
#
# Usage:
#   1. Copy this file: cp backend.hcl.example backend.hcl
#   2. Fill in your R2 credentials and account ID
#   3. Encrypt with SOPS: make encrypt-backend
#   4. Remove plaintext file: rm backend.hcl
#   5. Initialize Terraform: make init

bucket = "r2-terraform-state"
key    = "environments/talos-cluster-edatw-cluster/terraform.tfstate"
region = "auto"

# Replace with your Cloudflare account ID
# Format: https://<account-id>.r2.cloudflarestorage.com
endpoints = {
  s3 = "https://REPLACE_WITH_YOUR_CLOUDFLARE_ACCOUNT_ID.r2.cloudflarestorage.com"
}

# R2 API credentials (create at: https://dash.cloudflare.com → R2 → Manage R2 API Tokens)
# Required permissions: Object Read & Write
access_key = "REPLACE_WITH_R2_ACCESS_KEY_ID"
secret_key = "REPLACE_WITH_R2_SECRET_ACCESS_KEY"

# S3 compatibility settings (required for R2)
skip_credentials_validation = true
skip_requesting_account_id  = true
skip_metadata_api_check     = true
skip_region_validation      = true
skip_s3_checksum            = true
use_path_style              = true
